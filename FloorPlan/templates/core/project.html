{% extends 'base.html' %} {% load static %} {% block meta %}
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
{% endblock meta %} {% block content %}

{% comment %} Project Overview {% endcomment %}
<h1>Project Overview</h1>
<h2 class="project-name">Name: {{project.name}}</h1>
  <h2>Address: {{project.address}}</h2>

  <h2>Lot: {{project.lot_number}}</h2>
  <br>
  {% if user.is_project_manager %}
  <a class="edit-project-button" href="{% url 'edit_project' pk=project.pk %}">Edit Project</a>
  <a class="delete-project-button" href="{% url 'delete_project' pk=project.pk %}">Delete Project</a>
  {% endif %}

  {% comment %} End Project Overview {% endcomment %}

  {% comment %} Task Overview {% endcomment %}

  <div class="project-tasks">
    <h1 class="project-tasks">My Tasks</h1>
    <a id='update-button' class='hidden task-update-button' href="{% url 'project' pk=project.pk %}">Update Tasks</a>
    {% for task in tasks %}
    {% if task.is_complete == False and task.assignee == user %}
    <div class="form-group">
      <label for="inputName" class="col-md-1 control-label"></label>
      <div class="col-md-5">
        <div class="checkbox task-text">
          <input class='checkbox' type="checkbox" value="1" id="{{task.pk}}" />
          <label class='task-text project-tasks'><span class='{{task.category|lower }}'>
              Task: {{task.task|capfirst}} | Due: {{task.due_date}} | Assigned to:
              {{task.assignee}} | Category: {{task.category|lower }}</span></label>
        </div>

        {% if user.is_project_manager %}
        <div class='task-link-container task-text'><a class="small-button " href="{% url 'edit_task' pk=task.pk %}">Edit
            Task</a>
          <a class="task-text" href="{% url 'delete_task' pk=task.pk %} ">Delete Task</a>
          {% endif %}

        </div>
      </div>
    </div>
  </div>


  {% endif %}

  {% empty %}

  <div>
    <p>You are not associated with any tasks currently.</p>
  </div>

  {% if user.is_project_manager %}

  <div>
    <p>Create tasks by category below.</p>
  </div>

  {% endif %}

  {% endfor %}
  {% comment %} End Task Overview {% endcomment %}



  {% comment %} Tasks by Category {% endcomment %}

  <h1 class="project-categories">Categories</h1>

  <div class='category-container'>

    {% for category in categories %}
    <div class="category">
      <h2 class="category-text {{category.category|lower}} ">{{category.category}}</h2>
      {% if user.is_project_manager %}
      <a class='small-button' href="{% url 'new_task' pk=project.pk %}">Create New Task</a>

      {% endif %}

      {% for task in tasks %}
      {% if task.category == category %}
      {% if task.is_complete == True %}


      <div class="task strikethrough">
        <p class="task-text">{{task.task|capfirst}}</p>
      </div>
      {% else %}
      <div class="task">
        <p class="task-test">Task: {{task.task|capfirst}} | Due: {{task.due_date}} | Assigned to: {{task.assignee}}
          </label>
        </p>

        <a class='small-button' href="{% url 'edit_task' pk=task.pk %}">Edit Task</a>

      </div>
      {% endif %}
      {% endif %}
      {% endfor %}

    </div>

    {% endfor %}

  </div>


  {% comment %}===================== End Tasks by Category ====================={% endcomment %}

  {% comment %}===================== Custom Category ====================={% endcomment %}

  <div class="category-container">
    {% for projectcategory in projectcategories %}
    <div class="category">
      <h2 class="category-text custom-category {{projectcategory.category|lower}} ">{{projectcategory.category}}</h2>
      {% if user.is_project_manager %}
      <a class='small-button' href="{% url 'new_task_customcategory' pk=project.pk %}">Create New Task</a>
      <a class="small-button" href="{% url 'edit_category_customcategory' pk=projectcategory.pk %}">Edit Category</a>
      <a class="small-button" href="{% url 'delete_category_customcategory' pk=projectcategory.pk %}">Delete
        Category</a>
      {% endif %}

      {% for task in tasks %}
      {% if task.custom_category == projectcategory %}
      {% if task.is_complete == True %}

      <div class="task strikethrough">
        <p class="task-text">{{task.task|capfirst}}</p>
      </div>
      {% else %}
      <div class="task">
        <p class="task-test">Task: {{task.task|capfirst}} | Due: {{task.due_date}} | Assigned to: {{task.assignee}}
          </label>
        </p>

        <a class='small-button' href="{% url 'edit_task_customcategory' pk=task.pk %}">Edit Task</a>
      </div>

      {% endif %}
      {% endif %}

      {% endfor %}
    </div>
    {% endfor %}
  </div>

  {% if user.is_project_manager %}
  <div class="category-container">
    <a class='small-button' href="{% url 'new_category' pk=project.pk %}">Create Custom Category</a>
  </div>
  {% endif %}

  {% comment %} ======================= End Custom Category============================ {% endcomment %}

  {% comment %} ============================ TEAM ============================={% endcomment %}

  <h2>Team</h2>
  {% if user.is_project_manager %}
  <div>
    <a class='small-button' href="{% url 'add_team_member' pk=project.pk %}">Add New Team Member(s) To This Project</a>
  </div>
  {% endif %}

  <div class='teammember-container'>

    {% for teammember in teammembers %}

    <div class='teammember'>

      <p>Name: {{teammember.first_name}} {{teammember.last_name}} | username: {{teammember.username}}</p>

      {% empty %}
      <p> There are no team members associated with this project </p>

      {% if user.is_project_manager %}
      <div>
        <a class='small-button' href="{% url 'add_team_member' pk=project.pk %}">Add New Team Member(s) To This
          Project</a>
      </div>

      {% endif %}
    </div>
    {% endfor %}
  </div>

  {% comment %} End Team {% endcomment %}

  {% endblock content %}